<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analiz Sonucu - Pnomoni Tespiti</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }

        header {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border-bottom: 2px solid rgba(66, 153, 225, 0.3);
        }

        header h1 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 28px;
            font-weight: 700;
        }

        header nav a {
            color: #90cdf4;
            margin: 0 15px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 8px 16px;
            border-radius: 8px;
        }

        header nav a:hover {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
        }

        .doctor-name {
            color: #fbd38d;
            font-weight: 600;
            margin: 0 10px;
        }

        .auth-links {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-header {
            text-align: center;
            padding: 40px 0;
            color: white;
        }

        .result-header h1 {
            font-size: 42px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .result-card {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 30px auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            max-width: 1200px;
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .prediction-badge {
            display: inline-block;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 32px;
            font-weight: 700;
            margin: 20px 0;
            text-transform: uppercase;
        }

        .badge-normal {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .badge-pneumonia {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }

        .info-box {
            background: rgba(45, 55, 72, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .info-box h4 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .info-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(66, 153, 225, 0.1);
            color: #cbd5e0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-item strong {
            color: #90cdf4;
            font-weight: 600;
        }

        .images-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .image-box {
            background: rgba(45, 55, 72, 0.6);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .image-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(66, 153, 225, 0.3);
            border-color: rgba(66, 153, 225, 0.5);
        }

        .image-box h4 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            color: white;
            padding: 15px;
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .image-box img {
            width: 100%;
            height: auto;
            display: block;
        }

        .image-box p {
            padding: 15px;
            color: #a0aec0;
            font-size: 14px;
            margin: 0;
        }

        .btn-download {
            background: linear-gradient(135deg, #38b2ac 0%, #319795 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(56, 178, 172, 0.3);
            text-decoration: none;
            display: inline-block;
        }

        .btn-download:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(56, 178, 172, 0.4);
            color: white;
        }

        .btn-back {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            margin: 20px 10px;
            box-shadow: 0 10px 25px rgba(66, 153, 225, 0.3);
        }

        .btn-back:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(66, 153, 225, 0.4);
            color: white;
        }

        footer {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            color: #cbd5e0;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
            font-weight: 500;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
            border-top: 2px solid rgba(66, 153, 225, 0.3);
        }

        @media (max-width: 768px) {
            .result-header h1 {
                font-size: 28px;
            }

            .prediction-badge {
                font-size: 24px;
                padding: 10px 25px;
            }

            .result-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container d-flex justify-content-between align-items-center">
            <h1>ü´Å Akciger Roentgen Pnomoni Tespiti</h1>
            <nav class="auth-links">
                <a href="{{ url_for('index') }}">Ana Sayfa</a>
                <a href="{{ url_for('dashboard') }}">Dashboard</a>
                <a href="{{ url_for('history') }}">Gecmis</a>
                {% if current_doctor %}
                <span class="doctor-name">Dr. {{ current_doctor.name }}</span>
                <a href="{{ url_for('logout') }}">Cikis Yap</a>
                {% else %}
                <a href="{{ url_for('login') }}">Giris Yap</a>
                <a href="{{ url_for('register') }}">Kayit Ol</a>
                {% endif %}
            </nav>
        </div>
    </header>

    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
    <div class="container mt-3">
        {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="result-header">
        <h1>üî¨ Analiz Sonuclari</h1>
    </div>

    <div class="container">
        <div class="result-card">
            <div class="text-center">
                <h2 style="color: #2d3748; margin-bottom: 20px;">Tespit Sonucu</h2>
                <div class="prediction-badge {{ 'badge-normal' if prediction == 'NORMAL' else 'badge-pneumonia' }}">
                    {{ 'NORMAL' if prediction == 'NORMAL' else '‚ö†Ô∏è PNOMONI' }}
                </div>
            </div>

            <div class="info-box">
                <h4>üìä Analiz Detaylari</h4>
                <div class="info-item">
                    <strong>üéØ Guven Orani:</strong> {{ confidence }}%
                </div>
                <div class="info-item">
                    <strong>üïê Tarih ve Saat:</strong> {{ timestamp }}
                </div>
                {% if scan_id %}
                <div class="info-item">
                    <strong>üî¢ Tarama Numarasi:</strong> #{{ scan_id }}
                </div>
                {% endif %}
            </div>

            <div class="images-section">
                <div class="image-box">
                    <h4>üì∑ Orijinal Goruntu</h4>
                    <img src="{{ url_for('static', filename='uploads/' + filename) }}" alt="Yuklenen Goruntu">
                </div>
                
                {% if heatmap_filename %}
                <div class="image-box">
                    <h4>üî• Isil Harita (Grad-CAM)</h4>
                    <img src="{{ url_for('static', filename='heatmaps/' + heatmap_filename) }}" alt="Grad-CAM Heatmap">
                    <p>Kirmizi bolgeler, modelin karar verirken odaklandigi alanlari gosterir</p>
                </div>
                {% endif %}
            </div>

            <div class="text-center" style="margin-top: 40px;">
                {% if scan_id %}
                <a href="{{ url_for('generate_report', scan_id=scan_id) }}" class="btn-download">
                    <i class="fas fa-file-pdf"></i> PDF Rapor Indir
                </a>
                {% endif %}
                <a href="{{ url_for('index') }}" class="btn-back">
                    <i class="fas fa-arrow-left"></i> Geri Don
                </a>
            </div>
        </div>

        <div class="result-card" style="margin-top: 30px;">
            <h3 style="color: #1e3c72; font-weight: 700; margin-bottom: 25px;">üíä Pnomoni Hakkinda Detayli Bilgi</h3>
            
            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="color: #2d3748; font-weight: 600;">üîç Pnomoni Nedir?</h4>
                <p style="color: #4a5568; line-height: 1.8;">
                    Pnomoni, bir veya iki akcigerde hava keselerinin iltihaplanmasi sonucu ciddi bir enfeksiyondur. Bu iltihap, hava keselerinin sivi veya irinle dolmasina yol acar ve nefes almayi zorlastirir. Enfeksiyon bakteriler, virusler veya mantarlar tarafindan olusturulabilir.
                </p>
            </div>

            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="color: #2d3748; font-weight: 600;">ü©∫ Belirtiler</h4>
                <ul style="color: #4a5568; line-height: 2;">
                    <li>Yesil veya sari balgamli devaml oksuruk</li>
                    <li>Yuksek ates, titreme ve terleme</li>
                    <li>Kisa sureli nefes darligi</li>
                    <li>Gogus agrisi (ozellikle derin nefes alirken)</li>
                    <li>Yorgunluk, halsizlik ve istah kaybi</li>
                </ul>
            </div>

            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="color: #2d3748; font-weight: 600;">üíâ Tedavi Yontemleri</h4>
                <ul style="color: #4a5568; line-height: 2;">
                    <li><strong>Antibiyotikler:</strong> Bakteriyel pnomoni tedavisinde kullanilir</li>
                    <li><strong>Antiviral ilaclar:</strong> Viral pnomoni icin</li>
                    <li><strong>Destekleyici bakim:</strong> Oksijen tedavisi, dinlenme ve sivi alimi</li>
                    <li><strong>Hastaneye yatis:</strong> Ciddi vakalarda gerekebilir</li>
                </ul>
            </div>

            <div style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); padding: 25px; border-radius: 15px;">
                <h4 style="color: #e53e3e; font-weight: 700;">‚ö†Ô∏è Onemli Uyari</h4>
                <p style="color: #2d3748; line-height: 1.8; margin: 0;">
                    Bu sistem profesyonel tibbi teshisin yerini ALMAZ. Her zaman uzman bir hekime danismaniz siddetle tavsiye edilir. Erken teshis ve tedavi, pnomoninin etkisini azaltmak icin kritik oneme sahiptir.
                </p>
            </div>
        </div>
    </div>

    <footer>
        <p>¬© 2025 Akciger Roentgen Analiz Sistemi | Tum haklari saklidir - MUHAMMED MUHAMMED</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
