<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akciger Roentgen Pnomoni Tespiti</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }

        header {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid rgba(66, 153, 225, 0.3);
        }
        
        header h1 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 28px;
            font-weight: 700;
            margin: 0;
        }

        header nav a {
            color: #90cdf4;
            margin: 0 15px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 8px 16px;
            border-radius: 8px;
        }

        header nav a:hover {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
        }

        .doctor-name {
            color: #fbd38d;
            font-weight: 600;
            margin: 0 10px;
        }

        .auth-links {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .main-card {
            margin-top: 3rem;
            margin-bottom: 3rem;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .card-header-custom {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            padding: 2.5rem;
            text-align: center;
        }

        .card-header-custom h3 {
            color: white;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .card-header-custom p {
            color: rgba(255, 255, 255, 0.95);
            font-size: 16px;
        }

        .card-body {
            padding: 3rem;
        }

        .patient-info {
            background: rgba(45, 55, 72, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .patient-info h5 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .form-label {
            font-weight: 600;
            color: #cbd5e0;
            margin-bottom: 8px;
        }

        .form-control, .form-select {
            background: rgba(45, 55, 72, 0.5);
            border: 2px solid rgba(66, 153, 225, 0.3);
            border-radius: 10px;
            padding: 12px;
            transition: all 0.3s;
            color: #e2e8f0;
        }

        .form-control:focus, .form-select:focus {
            background: rgba(45, 55, 72, 0.7);
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
            color: #e2e8f0;
        }

        .form-control::placeholder {
            color: #a0aec0;
        }

        .upload-section {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, rgba(66, 153, 225, 0.2) 0%, rgba(102, 126, 234, 0.2) 100%);
            border: 2px dashed rgba(66, 153, 225, 0.5);
            border-radius: 20px;
            margin: 30px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(66, 153, 225, 0.3);
            border-color: #4299e1;
            background: linear-gradient(135deg, rgba(66, 153, 225, 0.3) 0%, rgba(102, 126, 234, 0.3) 100%);
        }

        .upload-icon {
            font-size: 60px;
            color: #4299e1;
            margin-bottom: 15px;
        }

        #file-name {
            color: #90cdf4;
            font-weight: 600;
            font-size: 18px;
        }

        .btn-submit {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            border: none;
            border-radius: 50px;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: 600;
            color: white;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(66, 153, 225, 0.3);
        }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(66, 153, 225, 0.4);
        }

        .info-section {
            margin-top: 50px;
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        .info-section h3 {
            background: linear-gradient(135deg, #4299e1 0%, #667eea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            font-size: 28px;
            margin-bottom: 20px;
        }

        .info-section p {
            color: #cbd5e0;
            line-height: 1.8;
            font-size: 16px;
        }

        .info-section ul {
            list-style: none;
            padding: 0;
        }

        .info-section li {
            padding: 12px 0;
            padding-left: 30px;
            position: relative;
            color: #cbd5e0;
        }

        .info-section li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #4299e1;
            font-weight: bold;
            font-size: 20px;
        }

        .info-section strong {
            color: #90cdf4;
        }

        footer {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(10px);
            color: #cbd5e0;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
            font-weight: 500;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
            border-top: 2px solid rgba(66, 153, 225, 0.3);
        }

        .progress-container {
            display: none;
            margin-top: 25px;
        }

        .progress {
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            background: rgba(45, 55, 72, 0.5);
        }

        .progress-bar {
            background: linear-gradient(90deg, #4299e1 0%, #667eea 100%);
            font-weight: 600;
        }

        #file-info {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(45, 55, 72, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(66, 153, 225, 0.2);
        }

        #selected-file-name {
            color: #90cdf4;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .btn-danger {
            background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
            border: none;
            border-radius: 25px;
            padding: 10px 25px;
            font-weight: 600;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 101, 101, 0.4);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 20px;
            }

            .card-header-custom h3 {
                font-size: 24px;
            }

            .card-body {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="container d-flex justify-content-between align-items-center">
            <h1>ğŸ« Akciger Roentgen Pnomoni Tespiti</h1>
            <nav class="auth-links">
                <a href="{{ url_for('index') }}">Ana Sayfa</a>
                <a href="{{ url_for('dashboard') }}">Dashboard</a>
                <a href="{{ url_for('history') }}">GeÃ§miÅŸ</a>
                {% if current_doctor %}
                <span class="doctor-name">Dr. {{ current_doctor.name }}</span>
                <a href="{{ url_for('logout') }}">Ã‡Ä±kÄ±ÅŸ Yap</a>
                {% else %}
                <a href="{{ url_for('login') }}">GiriÅŸ Yap</a>
                <a href="{{ url_for('register') }}">KayÄ±t Ol</a>
                {% endif %}
            </nav>
        </div>
    </header>

    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
    <div class="container mt-3">
        {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="main-card">
                    <div class="card-header-custom">
                        <h3>ğŸ”¬ Roentgen Goruntunuzu Yukleyin</h3>
                        <p>Pnomoni belirtilerini tespit etmek icin akciger roentgen goruntunuzu yukleyin</p>
                    </div>
                    <div class="card-body">
                        <form id="upload-form" action="{{ url_for('predict') }}" method="POST" enctype="multipart/form-data">
                            <div class="patient-info">
                                <h5>ğŸ“‹ Hasta Bilgileri (Opsiyonel)</h5>
                                <div class="mb-3">
                                    <label for="patient_name" class="form-label">Ad Soyad</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="patient_name" 
                                           name="patient_name" 
                                           placeholder="Ahmet YÄ±lmaz (sadece harf)"
                                           pattern="^[a-zA-ZÄŸÃ¼ÅŸÄ±Ã¶Ã§ÄÃœÅÄ°Ã–Ã‡\s]{2,}$"
                                           title="Sadece harf kullanÄ±labilir (en az 2 karakter)">
                                    <small style="color: #90cdf4; font-size: 12px;">*Sadece harf kullanÄ±n (rakam girilemez)</small>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="tc_kimlik" class="form-label">TC Kimlik No</label>
                                        <input type="text" 
                                               class="form-control" 
                                               id="tc_kimlik" 
                                               name="tc_kimlik" 
                                               placeholder="12345678901 (11 rakam)"
                                               maxlength="11"
                                               pattern="^\d{11}$"
                                               title="Tam 11 haneli rakam giriniz">
                                        <small style="color: #90cdf4; font-size: 12px;">*Opsiyonel - Tam 11 haneli rakam olmalÄ±</small>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="patient_phone" class="form-label">Telefon</label>
                                        <input type="tel" 
                                               class="form-control" 
                                               id="patient_phone" 
                                               name="patient_phone" 
                                               placeholder="5XX XXX XX XX (10 rakam)"
                                               pattern="^[0-9\s\-\(\)]{10,14}$"
                                               title="10 haneli telefon numarasÄ± giriniz (otomatik +90 eklenecek)">
                                        <small style="color: #90cdf4; font-size: 12px;">*Opsiyonel - Otomatik +90 eklenecek</small>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="patient_age" class="form-label">YaÅŸ</label>
                                        <input type="number" class="form-control" id="patient_age" name="patient_age" placeholder="YaÅŸ">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="patient_gender" class="form-label">Cinsiyet</label>
                                        <select class="form-control" id="patient_gender" name="patient_gender">
                                            <option value="Belirtilmemis">Belirtilmemis</option>
                                            <option value="Erkek">Erkek</option>
                                            <option value="Kadin">Kadin</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="notes" class="form-label">Notlar</label>
                                    <textarea class="form-control" id="notes" name="notes" rows="2" placeholder="Ek notlar..."></textarea>
                                </div>
                            </div>
                            
                            <label for="x-ray-upload" class="upload-section">
                                <div class="upload-icon">ğŸ“¤</div>
                                <span id="file-name">Roentgen goruntusunu sec</span>
                            </label>
                            <input type="file" id="x-ray-upload" name="file" accept=".jpg,.jpeg,.png" required hidden onchange="updateFileInfo()">
                            
                            <button type="submit" class="btn-submit">ğŸš€ Yukle ve Analiz Et</button>
                        </form>

                        <div id="file-info">
                            <p id="selected-file-name"></p>
                            <button type="button" class="btn btn-danger" onclick="removeFile()">âŒ Dosyayi Kaldir</button>
                        </div>

                        <div id="progress-container" class="progress-container">
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%" id="progress-bar">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-section">
            <h3>ï¿½ PnÃ¶moni HakkÄ±nda DetaylÄ± Bilgi</h3>
            
            <h4 style="color: #90cdf4; margin-top: 25px; margin-bottom: 15px;">ğŸ” PnÃ¶moni Nedir?</h4>
            <p>PnÃ¶moni, bir veya iki akciÄŸerde hava keselerinin iltihaplanmasÄ± sonucu ciddi bir enfeksiyondur. Bu iltihap, hava keselerinin sÄ±vÄ± veya irinle dolmasÄ±na yol aÃ§ar ve nefes almayÄ± zorlaÅŸtÄ±rÄ±r. Enfeksiyon bakteriler, virÃ¼sler veya mantarlar tarafÄ±ndan oluÅŸturulabilir.</p>

            <h4 style="color: #90cdf4; margin-top: 25px; margin-bottom: 15px;">ğŸ©º Belirtiler</h4>
            <ul>
                <li>YeÅŸil veya sarÄ± balgamlÄ± devamlÄ± Ã¶ksÃ¼rÃ¼k</li>
                <li>YÃ¼ksek ateÅŸ, titreme ve terleme</li>
                <li>KÄ±sa sÃ¼reli nefes darlÄ±ÄŸÄ±</li>
                <li>GÃ¶ÄŸÃ¼s aÄŸrÄ±sÄ± (Ã¶zellikle derin nefes alÄ±rken)</li>
                <li>Yorgunluk, halsizlik ve iÅŸtah kaybÄ±</li>
            </ul>

            <h4 style="color: #90cdf4; margin-top: 25px; margin-bottom: 15px;">ğŸ’‰ Tedavi YÃ¶ntemleri</h4>
            <ul>
                <li><strong>Antibiyotikler:</strong> Bakteriyel pnÃ¶moni tedavisinde kullanÄ±lÄ±r</li>
                <li><strong>Antiviral ilaÃ§lar:</strong> Viral pnÃ¶moni iÃ§in</li>
                <li><strong>Destekleyici bakÄ±m:</strong> Oksijen tedavisi, dinlenme ve sÄ±vÄ± alÄ±mÄ±</li>
                <li><strong>Hastaneye yatÄ±ÅŸ:</strong> Ciddi vakalarda gerekebilir</li>
            </ul>

            <h4 style="color: #90cdf4; margin-top: 25px; margin-bottom: 15px;">ğŸ’¡ Program NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h4>
            <p>Bu program, yÃ¼klediÄŸiniz rÃ¶ntgen gÃ¶rÃ¼ntÃ¼lerini analiz eder ve akciÄŸer enfeksiyonlarÄ±nÄ±n bilinen desenlerine gÃ¶re pnÃ¶moni belirtilerini arar.</p>
            <ul>
                <li><strong>AdÄ±m 1:</strong> AkciÄŸerlerinize ait bir rÃ¶ntgen gÃ¶rÃ¼ntÃ¼sÃ¼ yÃ¼klersiniz</li>
                <li><strong>AdÄ±m 2:</strong> GÃ¶rÃ¼ntÃ¼, pnÃ¶moniyi tespit etmek iÃ§in eÄŸitilmiÅŸ derin Ã¶ÄŸrenme modeli ile iÅŸlenir</li>
                <li><strong>AdÄ±m 3:</strong> Program gÃ¶rÃ¼ntÃ¼yÃ¼ analiz eder ve pnÃ¶moni belirtilerini gÃ¶sterip gÃ¶stermediÄŸini belirten bir tahmin saÄŸlar</li>
                <li><strong>AdÄ±m 4:</strong> SonuÃ§larÄ± anÄ±nda gÃ¶rebilir ve gerekli adÄ±mlarÄ± atabilirsiniz</li>
            </ul>
            
            <div style="background: rgba(45, 55, 72, 0.6); border-left: 4px solid #fc8181; padding: 25px; border-radius: 12px; margin-top: 30px; border: 1px solid rgba(252, 129, 129, 0.3); box-shadow: 0 4px 15px rgba(252, 129, 129, 0.1);">
                <p style="margin: 0; font-weight: 700; color: #fc8181; font-size: 18px;">
                    <i class="fas fa-exclamation-triangle"></i> <strong>Ã–nemli UyarÄ±</strong>
                </p>
                <p style="margin-top: 15px; margin-bottom: 0; color: #e2e8f0; line-height: 1.8;">
                    Bu sistem profesyonel tÄ±bbi teÅŸhisin yerini <strong style="color: #fc8181;">ALMAZ</strong>. Her zaman uzman bir hekime danÄ±ÅŸmanÄ±z ÅŸiddetle tavsiye edilir. Erken teÅŸhis ve tedavi, pnÃ¶moninin etkisini azaltmak iÃ§in kritik Ã¶neme sahiptir.
                </p>
            </div>
        </div>
    </div>

    <footer>
        <p>Â© 2025 Akciger Roentgen Analiz Sistemi | Tum haklari saklidir - MUHAMMED MUHAMMED</p>
    </footer>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        function updateFileInfo() {
            var input = document.getElementById("x-ray-upload");
            var fileName = input.files[0].name;
            document.getElementById("file-name").textContent = "âœ… " + fileName;
            document.getElementById("file-info").style.display = "block";
            document.getElementById("selected-file-name").textContent = "Secilen dosya: " + fileName;
        }

        function removeFile() {
            document.getElementById("x-ray-upload").value = "";
            document.getElementById("file-name").textContent = "Roentgen goruntusunu sec";
            document.getElementById("file-info").style.display = "none";
        }

        document.getElementById("upload-form").addEventListener("submit", function(event) {
            const patientName = document.getElementById("patient_name").value.trim();
            const tcKimlik = document.getElementById("tc_kimlik").value.trim();
            const phone = document.getElementById("patient_phone").value.trim();
            
            if (patientName && !/^[a-zA-ZÄŸÃ¼ÅŸÄ±Ã¶Ã§ÄÃœÅÄ°Ã–Ã‡\s]{2,}$/.test(patientName)) {
                alert("âŒ Hasta adÄ± sadece harf iÃ§ermelidir (rakam kullanÄ±lamaz)!");
                event.preventDefault();
                return false;
            }
            
            if (tcKimlik && !/^\d{11}$/.test(tcKimlik)) {
                alert("âŒ TC Kimlik No tam 11 haneli rakam olmalÄ±dÄ±r!");
                event.preventDefault();
                return false;
            }
            
            if (phone) {
                const phoneClean = phone.replace(/[\s\-\(\)]/g, '').replace(/^(\+90|0090|90|0)/, '');
                if (!/^\d{10}$/.test(phoneClean)) {
                    alert("âŒ Telefon numarasÄ± 10 haneli rakam olmalÄ±dÄ±r!");
                    event.preventDefault();
                    return false;
                }
            }
            
            event.preventDefault();
            
            document.getElementById("progress-container").style.display = "block";
            
            let progress = 0;
            let interval = setInterval(function() {
                progress += 10;
                document.getElementById("progress-bar").style.width = progress + "%";
                document.getElementById("progress-bar").textContent = progress + "%";
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(function() {
                        document.getElementById("upload-form").submit();
                    }, 300);
                }
            }, 200);
        });
    </script>

</body>
</html>
